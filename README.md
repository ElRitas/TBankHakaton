# Payment Link Generator API

–ü—Ä–æ—Å—Ç–æ–µ Ktor-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Kotlin –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–ª–∞—Ç—ë–∂–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Android, iOS, Desktop).

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:

```
./gradlew run
```

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### POST /payment

–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç—ë–∂–Ω–æ–π —Å—Å—ã–ª–∫–∏.

–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):

```
{
  "paymentId": "b1e29ec2-82d7-4b14-9509-f089f9110abc",
  "deviceOS": "Android",
  "webview": true
}
```

–ü–æ–ª—è –∑–∞–ø—Ä–æ—Å–∞:

- paymentId (string) ‚Äî UUID –ø–ª–∞—Ç–µ–∂–∞. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º UUID.
- deviceOS (string) ‚Äî –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: Android, iOS, Desktop.
- webview (boolean) ‚Äî –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ WebView (—Ç–æ–ª—å–∫–æ –¥–ª—è iOS).

–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (HTTP 200 OK):

```
{
  "link": "tinkoffbank://Main/tpay/b1e29ec2-82d7-4b14-9509-f089f9110abc",
  "status": 200
}
```

–ü—Ä–∏–º–µ—Ä—ã —Å—Å—ã–ª–æ–∫:

| deviceOS | webview | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ |
|----------|---------|------------------------|
| Android  | –ª—é–±–æ–π   | tinkoffbank://Main/tpay/{paymentId} |
| iOS      | true    | https://www.tinkoff.ru/tpay/{paymentId} |
| iOS      | false   | bank100000000004://Main/tpay/{paymentId} |
| Desktop  | –ª—é–±–æ–π   | https://www.tinkoff.ru/tpay/{paymentId} |

### –û—à–∏–±–∫–∏

–ö–æ–¥—ã –æ—à–∏–±–æ–∫ –∏ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏–µ:

- 400: Invalid JSON format or wrong UUID ‚Äî –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON –∏–ª–∏ UUID
- 400: Unsupported deviceOS: {deviceOS} ‚Äî –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- 400: Invalid UUID format: {paymentId} ‚Äî –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç UUID
- 500: Something went wrong ‚Äî –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

–ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏ (HTTP 400 Bad Request):

```
{
  "error": "Invalid UUID format: not-a-valid-uuid",
  "code": 400
}
```

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Ktor (server, routing, content negotiation)
- Kotlin Serialization (–¥–ª—è JSON)
- Netty (–∫–∞–∫ HTTP —Å–µ—Ä–≤–µ—Ä)

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç POST-–∑–∞–ø—Ä–æ—Å —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–ª–∞—Ç–µ–∂–∞.
2. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç paymentId –∫–∞–∫ UUID.
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ deviceOS.
4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–ª–∞—Ç—ë–∂–Ω—É—é —Å—Å—ã–ª–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –Ω–∞–ª–∏—á–∏—è webview.
5. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∫—É –∫–ª–∏–µ–Ω—Ç—É.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- JDK 17+
- Gradle

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è ‚Äî –ø–∏—à–∏—Ç–µ!

---

–•–æ—á–µ—à—å, —è —Å—Ä–∞–∑—É –µ—â—ë –¥–∞–º –ø—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã `curl`, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã—Å—Ç—Ä–æ —Ç–µ—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª? üöÄ  
(–Ω–∞–ø—Ä–∏–º–µ—Ä `curl -X POST http://localhost:8080/payment ...`)
